Dim piezas(6) As Variant

Sub ConfigurarPiezas()
    piezas(0) = Array(Array(1, 1, 1, 1)) ' Línea
    piezas(1) = Array(Array(1, 1), Array(1, 1)) ' Cuadrado
    piezas(2) = Array(Array(0, 1, 0), Array(1, 1, 1)) ' T
    piezas(3) = Array(Array(1, 1, 0), Array(0, 1, 1)) ' Z
    piezas(4) = Array(Array(0, 1, 1), Array(1, 1, 0)) ' S
    piezas(5) = Array(Array(1, 0, 0), Array(1, 1, 1)) ' L
    piezas(6) = Array(Array(0, 0, 1), Array(1, 1, 1)) ' L invertida
End Sub

Sub DibujarPieza(ByVal pieza As Variant, ByVal x As Integer, ByVal y As Integer)
    Dim i As Integer, j As Integer
    For i = LBound(pieza) To UBound(pieza)
        For j = LBound(pieza(i)) To UBound(pieza(i))
            If pieza(i)(j) = 1 Then
                Cells(y + i, x + j).Interior.Color = RGB(0, 255, 0) ' Verde
            End If
        Next j
    Next i
End Sub

Sub LimpiarTablero()
    Dim i As Integer, j As Integer
    For i = 1 To 20
        For j = 1 To 10
            Cells(i, j).Interior.Color = RGB(255, 255, 255) ' Blanco
        Next j
    Next i
End Sub

Function Colision(ByVal pieza As Variant, ByVal x As Integer, ByVal y As Integer) As Boolean
    Dim i As Integer, j As Integer
    For i = LBound(pieza) To UBound(pieza)
        For j = LBound(pieza(i)) To UBound(pieza(i))
            If pieza(i)(j) = 1 Then
                If y + i > 20 Or x + j < 1 Or x + j > 10 Or Cells(y + i, x + j).Interior.Color <> RGB(255, 255, 255) Then
                    Colision = True
                    Exit Function
                End If
            End If
        Next j
    Next i
    Colision = False
End Function

Sub IniciarJuego()
    Dim piezaActual As Variant
    Dim x As Integer, y As Integer
    Dim siguientePieza As Variant

    Call ConfigurarPiezas
    Call LimpiarTablero

    ' Genera la primera pieza
    Randomize
    piezaActual = piezas(Int(Rnd * 7))
    x = 5
    y = 1

    ' Dibuja la primera pieza
    If Not Colision(piezaActual, x, y) Then
        DibujarPieza piezaActual, x, y
    Else
        MsgBox "Game Over"
        Exit Sub
    End If

    ' Genera la próxima pieza (opcional)
    siguientePieza = piezas(Int(Rnd * 7))
    ' Puedes dibujar la próxima pieza en otra ubicación si deseas

    MsgBox "Juego iniciado. Usa las teclas para mover la pieza."
End Sub

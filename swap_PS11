
function Modificar-Archivo {
    param (
        [string]$rutaArchivo
    )

    # Leer todas las líneas del archivo
    $lineas = Get-Content -Path $rutaArchivo

    # Crear una lista para almacenar las nuevas líneas
    $nuevasLineas = @()

    foreach ($linea in $lineas) {
        if ($linea.Length -ge 111) {
            if ($linea[110] -match '\d') {
                # Modificar la línea
                $linea = $linea.Substring(0, 110) + "0" + $linea.Substring(111)
            }
        }
        $nuevasLineas += $linea
    }

    # Sobrescribir el archivo con las nuevas líneas
    $nuevasLineas | Set-Content -Path $rutaArchivo
}

function Procesar-Archivos {
    param (
        [string]$directorio
    )

    # Recorrer todos los archivos del directorio y subdirectorios
    Get-ChildItem -Path $directorio -Recurse -Filter "*.txt" | ForEach-Object {
        if ($_.Name -like "ABM_HSBC*") {
            # Verificar que el archivo no esté vacío
            if ($_.Length -gt 0) {
                Modificar-Archivo -rutaArchivo $_.FullName
            }
        }
    }
}

# Ruta del directorio a procesar
$rutaRed = "\\\\Wftsf1106\\NYLCD\\BankAssurance\\Assurant\\Receive"

# Procesar los archivos
Procesar-Archivos -directorio $rutaRed

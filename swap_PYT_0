import os
import shutil
import pandas as pd

# Función principal
def procesar_archivos(ruta_excel, columna_original, columna_nueva, ubicacion_busqueda, ubicacion_destino):
    # Leer el Excel
    try:
        df = pd.read_excel(ruta_excel)
    except Exception as e:
        print(f"Error al leer el archivo Excel: {e}")
        return

    # Iterar por las filas del Excel
    for index, row in df.iterrows():
        nombre_original = str(row[columna_original]).strip()
        nombre_nuevo = str(row[columna_nueva]).strip()
        
        # Buscar archivos que coincidan en la ubicación de red
        encontrado = False
        for archivo in os.listdir(ubicacion_busqueda):
            if nombre_original in archivo:
                encontrado = True
                extension = os.path.splitext(archivo)[1]
                nombre_completo_original = os.path.join(ubicacion_busqueda, archivo)
                nombre_completo_nuevo = os.path.join(ubicacion_destino, f"{nombre_nuevo}{extension}")
                
                # Mover y renombrar el archivo
                try:
                    shutil.move(nombre_completo_original, nombre_completo_nuevo)
                    print(f"Archivo '{archivo}' renombrado a '{nombre_nuevo}{extension}' y movido a {ubicacion_destino}")
                except Exception as e:
                    print(f"Error al mover el archivo '{archivo}': {e}")
                break

        if not encontrado:
            print(f"No se encontró ningún archivo con el nombre '{nombre_original}' en {ubicacion_busqueda}")

# Parámetros
ruta_excel = input("Ingrese la ruta del archivo Excel: ").strip()
columna_original = input("Ingrese el nombre de la columna con los nombres originales: ").strip()
columna_nueva = input("Ingrese el nombre de la columna con los nombres nuevos: ").strip()
ubicacion_busqueda = input("Ingrese la ubicación de red donde buscar los archivos: ").strip()
ubicacion_destino = input("Ingrese la ubicación de red donde mover los archivos: ").strip()

# Ejecutar
procesar_archivos(ruta_excel, columna_original, columna_nueva, ubicacion_busqueda, ubicacion_destino)

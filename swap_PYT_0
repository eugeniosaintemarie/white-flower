import os
import shutil
import pandas as pd

# Función principal
def procesar_archivos():
    # Variables definidas
    ruta_excel = "C:/ruta/al/archivo.xlsx"  # Ruta completa al archivo Excel
    nombre_columna_original = "Nombre Original"  # Nombre de la columna con los nombres originales
    nombre_columna_nueva = "Nombre Nuevo"  # Nombre de la columna con los nombres nuevos
    ubicacion_busqueda = "C:/ruta/de/busqueda/"  # Carpeta donde buscar los archivos
    ubicacion_destino = "C:/ruta/destino/"  # Carpeta donde mover los archivos

    # Leer el Excel omitiendo la cabecera
    try:
        df = pd.read_excel(ruta_excel)
    except Exception as e:
        print(f"Error al leer el archivo Excel: {e}")
        return

    # Validar si las columnas existen
    if nombre_columna_original not in df.columns or nombre_columna_nueva not in df.columns:
        print(f"El Excel no contiene las columnas '{nombre_columna_original}' o '{nombre_columna_nueva}'")
        return

    # Iterar por las filas del Excel
    for index, row in df.iterrows():
        nombre_original = str(row[nombre_columna_original]).strip()
        nombre_nuevo = str(row[nombre_columna_nueva]).strip()
        
        # Construir ruta completa del archivo original
        ruta_original = os.path.join(ubicacion_busqueda, nombre_original)
        
        if os.path.exists(ruta_original):
            # Construir ruta completa del archivo con nuevo nombre
            ruta_nueva = os.path.join(ubicacion_destino, nombre_nuevo)
            
            try:
                shutil.move(ruta_original, ruta_nueva)
                print(f"Archivo '{nombre_original}' renombrado a '{nombre_nuevo}' y movido a {ubicacion_destino}")
            except Exception as e:
                print(f"Error al mover el archivo '{nombre_original}': {e}")
        else:
            print(f"No se encontró el archivo '{nombre_original}' en {ubicacion_busqueda}")

# Ejecutar
procesar_archivos()

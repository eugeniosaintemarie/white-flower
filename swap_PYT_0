import os
import shutil
import pandas as pd

# Función principal
def procesar_archivos():
    # Variables definidas
    ruta_excel = "C:/ruta/al/archivo.xlsx"  # Ruta completa al archivo Excel
    indice_columna_original = 0  # Índice de la columna con los nombres originales (columna A = 0)
    indice_columna_nueva = 1  # Índice de la columna con los nuevos nombres (columna B = 1)
    ubicacion_busqueda = "C:/ruta/de/busqueda/"  # Carpeta donde buscar los archivos
    ubicacion_destino = "C:/ruta/destino/"  # Carpeta donde copiar los archivos

    # Leer el Excel omitiendo la cabecera
    try:
        df = pd.read_excel(ruta_excel, header=0, usecols=[indice_columna_original, indice_columna_nueva])
    except Exception as e:
        print(f"Error al leer el archivo Excel: {e}")
        return

    # Iterar por las filas del Excel
    for index, row in df.iterrows():
        nombre_original = str(row[indice_columna_original]).strip()
        nombre_nuevo = str(row[indice_columna_nueva]).strip()
        
        # Construir ruta completa del archivo original
        ruta_original = os.path.join(ubicacion_busqueda, nombre_original)
        
        if os.path.exists(ruta_original):
            # Construir ruta completa del archivo con nuevo nombre
            ruta_nueva = os.path.join(ubicacion_destino, nombre_nuevo)
            
            try:
                shutil.copy(ruta_original, ruta_nueva)
                print(f"Archivo '{nombre_original}' copiado y renombrado a '{nombre_nuevo}' en {ubicacion_destino}")
            except Exception as e:
                print(f"Error al copiar el archivo '{nombre_original}': {e}")
        else:
            print(f"No se encontró el archivo '{nombre_original}' en {ubicacion_busqueda}")

# Ejecutar
procesar_archivos()
